"use strict";(self["webpackChunkhex_vue_ec_website"]=self["webpackChunkhex_vue_ec_website"]||[]).push([[206],{535:function(e,t,l){l.d(t,{Z:function(){return y}});var a=l(3396),s=l(7139),i=l(9242);const n={"aria-label":"Page navigation example"},d={class:"pagination justify-content-center"},r=(0,a._)("span",{"aria-hidden":"true"},"«",-1),o=[r],u={key:0,class:"page-link"},c=["onClick"],p=(0,a._)("span",{"aria-hidden":"true"},"»",-1),_=[p];function m(e,t,l,r,p,m){return(0,a.wg)(),(0,a.iD)("nav",n,[(0,a._)("ul",d,[(0,a._)("li",{class:(0,s.C_)([{disabled:!l.pages.has_pre},"page-item"])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,i.iM)((e=>m.updatePage(l.pages.current_page-1)),["prevent"]))},o)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,s.C_)(["page-item",{active:l.pages.current_page===e}]),key:e},[e===l.pages.current_page?((0,a.wg)(),(0,a.iD)("span",u,(0,s.zw)(e),1)):((0,a.wg)(),(0,a.iD)("a",{key:1,class:"page-link",href:"#",onClick:(0,i.iM)((t=>m.updatePage(e)),["prevent"])},(0,s.zw)(e),9,c))],2)))),128)),(0,a._)("li",{class:(0,s.C_)(["page-item",{disabled:!l.pages.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,i.iM)((e=>m.updatePage(l.pages.current_page+1)),["prevent"]))},_)],2)])])}var h={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)}}},g=l(89);const b=(0,g.Z)(h,[["render",m]]);var y=b},7570:function(e,t,l){l.r(t),l.d(t,{default:function(){return Fe}});var a=l(3396),s=l(7139),i=l(9242);const n={class:"container"},d=(0,a._)("p",{class:"h2 text-center my-4"},[(0,a._)("span",{class:"text-dark bg-secondary"},"訂單管理")],-1),r={class:"row justify-content-center"},o={class:"col-10"},u={class:"table align-middle bg-white rounded-3 d-none d-lg-table"},c=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"購買時間"),(0,a._)("th",null,"Email"),(0,a._)("th",null,"購買品項"),(0,a._)("th",null,"應付金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"操作")])],-1),p={style:{width:"100px"}},_={class:"row"},m={class:"col-12 col-md-6"},h={class:"form-check form-switch"},g=["id","onUpdate:modelValue","onChange"],b=["for"],y={class:"col-12 col-md-6"},w={key:0,class:"text-primary"},f={key:1,class:"text-light"},v={class:"btn-group btn-group-sm"},k=["onClick","disabled"],O=["onClick","disabled"],x={class:"fas fa-spinner fa-pulse"},D=(0,a.Uk)(" 刪除 "),z={class:"table align-middle bg-white rounded-3 d-inline-table d-lg-none"},C=(0,a._)("th",{style:{width:"100px"}},"購買時間",-1),$=(0,a._)("th",null,"Email",-1),M=(0,a._)("th",null,"購買品項",-1),j=(0,a._)("th",null,"應付金額",-1),R=(0,a._)("th",null,"是否付款",-1),S={class:"form-check form-switch"},E=["id","onUpdate:modelValue","onChange"],L=["for"],P={key:0,class:"text-primary"},Z={key:1,class:"text-light"},H=(0,a._)("th",null,"操作",-1),U={class:"btn-group btn-group-sm"},Y=["onClick","disabled"],K=["onClick","disabled"],V={class:"fas fa-spinner fa-pulse"},q=(0,a.Uk)(" 刪除 ");function W(e,t,l,W,F,G){const I=(0,a.up)("Loading"),N=(0,a.up)("Pagination"),A=(0,a.up)("OrderModal"),B=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(I,{"is-ready":F.isReady},null,8,["is-ready"]),(0,a._)("div",n,[d,(0,a._)("div",r,[(0,a._)("div",o,[(0,a._)("table",u,[c,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(F.orders,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",p,(0,s.zw)(e.$filters.timeConvert(t.create_at)),1),(0,a._)("td",null,(0,s.zw)(t.user.email),1),(0,a._)("td",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id+e.id},(0,s.zw)(e.product.title)+" "+(0,s.zw)(e.qty)+" / "+(0,s.zw)(e.product.unit),1)))),128))]),(0,a._)("td",null,(0,s.zw)(e.$filters.currency(t.total)),1),(0,a._)("td",null,[(0,a._)("div",_,[(0,a._)("div",m,[(0,a._)("div",h,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`enableSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,"true-value":!0,"false-value":!1,onChange:e=>G.updateEnableStatus(t)},null,40,g),[[i.e8,t.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`enableSwitch${t.id}}`},null,8,b)])]),(0,a._)("div",y,[t.is_paid?((0,a.wg)(),(0,a.iD)("span",w,"已付款")):((0,a.wg)(),(0,a.iD)("span",f,"未付款"))])])]),(0,a._)("td",null,[(0,a._)("div",v,[(0,a._)("button",{type:"button",class:"btn btn-outline-success",onClick:e=>G.openModal(t),disabled:F.isLoading===t.id}," 檢視 ",8,k),(0,a._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e=>G.openDelModal(t),disabled:F.isLoading===t.id},[(0,a.wy)((0,a._)("i",x,null,512),[[i.F8,F.isLoading===t.id]]),D],8,O)])])])))),128))])]),(0,a._)("table",z,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(F.orders,(t=>((0,a.wg)(),(0,a.iD)("tbody",{key:t.id},[(0,a._)("tr",null,[C,(0,a._)("td",null,(0,s.zw)(e.$filters.timeConvert(t.create_at)),1)]),(0,a._)("tr",null,[$,(0,a._)("td",null,(0,s.zw)(t.user.email),1)]),(0,a._)("tr",null,[M,(0,a._)("td",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id+e.id},(0,s.zw)(e.product.title)+" "+(0,s.zw)(e.qty)+"/"+(0,s.zw)(e.product.unit),1)))),128))])]),(0,a._)("tr",null,[j,(0,a._)("td",null,(0,s.zw)(e.$filters.currency(t.total)),1)]),(0,a._)("tr",null,[R,(0,a._)("td",null,[(0,a._)("div",S,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`enableSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,"true-value":!0,"false-value":!1,onChange:e=>G.updateEnableStatus(t)},null,40,E),[[i.e8,t.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`enableSwitch${t.id}}`},null,8,L),t.is_paid?((0,a.wg)(),(0,a.iD)("span",P,"已付款")):((0,a.wg)(),(0,a.iD)("span",Z,"未付款"))])])]),(0,a._)("tr",null,[H,(0,a._)("td",null,[(0,a._)("div",U,[(0,a._)("button",{type:"button",class:"btn btn-outline-success",onClick:e=>G.openModal(t),disabled:F.isLoading===t.id}," 檢視 ",8,Y),(0,a._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e=>G.openDelModal(t),disabled:F.isLoading===t.id},[(0,a.wy)((0,a._)("i",V,null,512),[[i.F8,F.isLoading===t.id]]),q],8,K)])])])])))),128))])])]),(0,a.Wm)(N,{pages:F.pagination,onEmitPages:G.getOrders},null,8,["pages","onEmitPages"]),(0,a.Wm)(A,{"temp-order":F.tempOrder,onGetOrders:G.getOrders,onEnableStatus:G.updateEnableStatus,ref:"adminOrder"},null,8,["temp-order","onGetOrders","onEnableStatus"]),(0,a.Wm)(B,{"del-item":F.tempOrder,onRemoveItem:G.removeOrder,ref:"delModal"},null,8,["del-item","onRemoveItem"])])],64)}const F={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},G={class:"modal-dialog modal-xl",role:"document"},I={class:"modal-content border-0"},N=(0,a._)("div",{class:"modal-header bg-success text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),A={class:"modal-body"},B={class:"row"},J={class:"col-12"},Q=(0,a._)("h3",null,"用戶資料",-1),T={class:"table"},X={key:0},ee=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),te=(0,a._)("th",null,"Email",-1),le=(0,a._)("th",null,"電話",-1),ae=(0,a._)("th",null,"地址",-1),se={class:"col-12"},ie=(0,a._)("h3",null,"訂單細節",-1),ne={class:"table"},de=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),re=(0,a._)("th",null,"下單時間",-1),oe=(0,a._)("th",null,"付款時間",-1),ue={key:0},ce={key:1},pe=(0,a._)("th",null,"付款狀態",-1),_e={key:0,class:"text-success"},me={key:1,class:"text-muted"},he=(0,a._)("th",null,"總金額",-1),ge={class:"col-12"},be=(0,a._)("h3",null,"選購商品",-1),ye={class:"table"},we=(0,a._)("thead",null,[(0,a._)("tr")],-1),fe={class:"text-end"},ve={class:"col-12"},ke={class:"d-flex justify-content-end"},Oe={class:"row"},xe={class:"col-12 col-md-6"},De={class:"form-check form-switch"},ze=["id"],Ce=["for"],$e={class:"col-12 col-md-6"},Me={key:0,class:"text-primary"},je={key:1,class:"text-light"},Re={class:"modal-footer"},Se=(0,a._)("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"}," 取消 ",-1);function Ee(e,t,l,n,d,r){return(0,a.wg)(),(0,a.iD)("div",F,[(0,a._)("div",G,[(0,a._)("div",I,[N,(0,a._)("div",A,[(0,a._)("div",B,[(0,a._)("div",J,[Q,(0,a._)("table",T,[e.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",X,[(0,a._)("tr",null,[ee,(0,a._)("td",null,(0,s.zw)(e.tempOrder.user.name),1)]),(0,a._)("tr",null,[te,(0,a._)("td",null,(0,s.zw)(e.tempOrder.user.email),1)]),(0,a._)("tr",null,[le,(0,a._)("td",null,(0,s.zw)(e.tempOrder.user.tel),1)]),(0,a._)("tr",null,[ae,(0,a._)("td",null,(0,s.zw)(e.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",se,[ie,(0,a._)("table",ne,[(0,a._)("tbody",null,[(0,a._)("tr",null,[de,(0,a._)("td",null,(0,s.zw)(e.tempOrder.id),1)]),(0,a._)("tr",null,[re,(0,a._)("td",null,(0,s.zw)(e.$filters.timeConvert(e.tempOrder.create_at)),1)]),(0,a._)("tr",null,[oe,(0,a._)("td",null,[e.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",ue,(0,s.zw)(e.$filters.timeConvert(e.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",ce,"時間不正確"))])]),(0,a._)("tr",null,[pe,(0,a._)("td",null,[e.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",_e,"已付款")):((0,a.wg)(),(0,a.iD)("span",me,"尚未付款"))])]),(0,a._)("tr",null,[he,(0,a._)("td",null,(0,s.zw)(e.$filters.currency(e.tempOrder.total)),1)])])])]),(0,a._)("div",ge,[be,(0,a._)("table",ye,[we,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.tempOrder.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",null,(0,s.zw)(t.product.title),1),(0,a._)("td",null,(0,s.zw)(t.qty)+" / "+(0,s.zw)(t.product.unit),1),(0,a._)("td",fe,(0,s.zw)(e.$filters.currency(t.product.price)),1)])))),128))])])]),(0,a._)("div",ve,[(0,a._)("div",ke,[(0,a._)("div",Oe,[(0,a._)("div",xe,[(0,a._)("div",De,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`enableSwitch${e.tempOrder.id}`,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tempOrder.is_paid=t),"true-value":!0,"false-value":!1},null,8,ze),[[i.e8,e.tempOrder.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`enableSwitch${e.tempOrder.id}}`},null,8,Ce)])]),(0,a._)("div",$e,[e.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("span",Me,"已付款")):((0,a.wg)(),(0,a.iD)("span",je,"未付款"))])])])])])]),(0,a._)("div",Re,[Se,(0,a._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t[1]||(t[1]=t=>e.$emit("enable-status",e.tempOrder))}," 修改付款狀態 ")])])])],512)}var Le=l(1339),Pe={props:["temp-order"],mixins:[Le.Z]},Ze=l(89);const He=(0,Ze.Z)(Pe,[["render",Ee]]);var Ue=He,Ye=l(3167),Ke=l(535),Ve=l(5517),qe={data(){return{orders:[],tempOrder:{},pagination:{},isReady:!1,isLoading:"",OrderModal:""}},inject:["emitter"],components:{OrderModal:Ue,DelModal:Ye.Z,Pagination:Ke.Z,Loading:Ve.Z},methods:{getOrders(e=1){this.isReady=!1;const t=`https://vue3-course-api.hexschool.io/v2/api/hyxfish27/admin/orders?page=${e}`;this.$http.get(t).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isReady=!0})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:e.response.data.message,emoji:"emoji-dizzy"})}))},removeOrder(e){this.isReady=!1;const t=`https://vue3-course-api.hexschool.io/v2/api/hyxfish27/admin/order/${e}`;this.$http.delete(t).then((e=>{this.emitter.emit("push-message",{style:"success",title:e.data.message,emoji:"emoji-laughing"}),this.getOrders(),this.isReady=!0})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:e.response.data.message,emoji:"emoji-dizzy"}),this.isReady=!0})),this.$refs.delModal.hideModal()},updateEnableStatus(e){this.isReady=!1;const t=`https://vue3-course-api.hexschool.io/v2/api/hyxfish27/admin/order/${e.id}`,l={is_paid:e.is_paid};this.$http.put(t,{data:l}).then((e=>{this.emitter.emit("push-message",{style:"success",title:e.data.message,emoji:"emoji-laughing"}),this.getOrders(this.pagination.current_page),this.isReady=!0})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:e.response.data.message,emoji:"emoji-dizzy"}),this.isReady=!0})),this.$refs.adminOrder.hideModal()},openModal(e){this.tempOrder={...e},this.$refs.adminOrder.openModal()},openDelModal(e){this.tempOrder={...e},this.$refs.delModal.openModal()}},mounted(){this.getOrders()}};const We=(0,Ze.Z)(qe,[["render",W]]);var Fe=We}}]);
//# sourceMappingURL=206.e2e527df.js.map